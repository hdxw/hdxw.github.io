<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>npm安装模块报错`node-gyp rebuild` | 吴家兴的博客</title>
    
    
        <meta property="og:site_name" content="吴家兴的博客">
    
    
        <meta property="article:author" content="WuJiaxing">
    
    
        <link rel="icon" href="/img/favicon.ico">
    
    
<link rel="stylesheet" href="/css/minireset.min.css">

    
<link rel="stylesheet" href="/css/all.min.css">

    
<link rel="stylesheet" href="/css/csshake.min.css">

    
<link rel="stylesheet" href="/css/hljs/lioshi.css">

    
<link rel="stylesheet" href="/css/jquery.fancybox.min.css">

    
<link rel="stylesheet" href="/styl/main.css">

    
<script src="/js/jquery.min.js"></script>

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/jquery.fancybox.min.js"></script>

    
<script src="/js/clipboard.min.js"></script>

    
<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <header>
  <div class="outer">
    <div class="inner">
      <h1 class="logo-wrap">
        <a>吴家兴的博客<b><sup>1.2</sup></b></a>
      </h1>
    </div>
    <div class="inner">
      <nav class="main-nav">
        
          
            <a href="/">首页</a>
          
        
          
            <a href="/archives">归档</a>
          
        
          
            <a href="/categories">分类</a>
          
        
          
            <a href="/tags">标签</a>
          
        
          
            <a href="/friends">友链</a>
          
        
          
            <a href="/about">关于</a>
          
        
          
            <div class="dropdown">
              <a class="dropbtn">个人项目</a>
              <div class="dropdown-content">
                
                  <a href="http://prowiki.wujiaxing.cn/" target="_blank" rel="noopener">Hexo主题</a>
                
                  <a href="https://readflag.cn/" target="_blank" rel="noopener">CTF在线工具</a>
                
                  <a href="https://search.readflag.cn/" target="_blank" rel="noopener">CTF题目搜索</a>
                
              </div>
            </div>
          
        
      </nav>
    </div>
  </div>
</header>
    <div class="content">
        <section class="outer">
    <article>
        <div class="article-title">
    <h2>
        <a href="/2019/08/21/a6e104b9/" class="shake shake-little" title="npm安装模块报错`node-gyp rebuild`">
            
            npm安装模块报错`node-gyp rebuild`
        </a>
    </h2>
    <div class="meta_box">
    
        
        
            
                
        
        <div class="meta meta_auth">
            <img src="/img/default.png" alt="head" />
            <p>anonymous</p>
        </div>
    
        
            <div class="meta meta_cate">
                <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
                <p><a class="article-category-link" href="/categories/kfbc/">开发报错</a></p>
            </div>
        
        
        <div class="meta meta_date">
            <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
            <p>发布于：2019年08月21日</p>
        </div>
    
        <div class="meta meta_update">
            <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
            <p>更新于：2022年03月09日</p>
        </div>
    </div>
    
  <div class="post_tags">
    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/node/" rel="tag"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>node</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>python</a></li></ul>
  </div>


</div>

        <hr>
        <div class="article-entry">
            
            
            
            <p>要运行一个依赖nodejs模块的单独js文件，执行安装模块时报错</p>
<a id="more"></a>

<h2 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h2><p>安装的模块名称（这个不重要）：png-img</p>
<p>下面是完整输出信息，路径做了一些隐藏处理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">E:\fakepath&gt;npm i -g png-img<br><br>&gt; png-img@2.2.0 install C:\Users\fakepath\AppData\Roaming\npm\node_modules\png-img<br>&gt; node-gyp rebuild<br><br><br>C:\Users\fakepath\AppData\Roaming\npm\node_modules\png-img&gt;if not defined npm_config_node_gyp (node &quot;C:\Program Files\nodejs<br>\node_modules\npm\node_modules\npm-lifecycle\node-gyp-bin\\..\..\node_modules\node-gyp\bin\node-gyp.js&quot; rebuild )  else<br>(node &quot;C:\Program Files\nodejs\node_modules\npm\node_modules\node-gyp\bin\node-gyp.js&quot; rebuild )<br>gyp ERR! configure error<br>gyp ERR! stack Error: Command failed: C:\Program Files\Python37\python.EXE -c import sys; print &quot;%s.%s.%s&quot; % sys.version<br>_info[:3];<br>gyp ERR! stack   File &quot;&lt;string&gt;&quot;, line 1<br>gyp ERR! stack     import sys; print &quot;%s.%s.%s&quot; % sys.version_info[:3];<br>gyp ERR! stack                                ^<br>gyp ERR! stack SyntaxError: invalid syntax<br>gyp ERR! stack<br>gyp ERR! stack     at ChildProcess.exithandler (child_process.js:294:12)<br>gyp ERR! stack     at ChildProcess.emit (events.js:189:13)<br>gyp ERR! stack     at maybeClose (internal&#x2F;child_process.js:970:16)<br>gyp ERR! stack     at Process.ChildProcess._handle.onexit (internal&#x2F;child_process.js:259:5)<br>gyp ERR! System Windows_NT 6.1.7601<br>gyp ERR! command &quot;C:\\Program Files\\nodejs\\node.exe&quot; &quot;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\node<br>-gyp\\bin\\node-gyp.js&quot; &quot;rebuild&quot;<br>gyp ERR! cwd C:\Users\fakepath\AppData\Roaming\npm\node_modules\png-img<br>gyp ERR! node -v v10.15.1<br>gyp ERR! node-gyp -v v3.8.0<br>gyp ERR! not ok<br>npm ERR! code ELIFECYCLE<br>npm ERR! errno 1<br>npm ERR! png-img@2.2.0 install: &#96;node-gyp rebuild&#96;<br>npm ERR! Exit status 1<br>npm ERR!<br>npm ERR! Failed at the png-img@2.2.0 install script.<br>npm ERR! This is probably not a problem with npm. There is likely additional logging output above.<br><br>npm ERR! A complete log of this run can be found in:<br>npm ERR!     C:\Users\fakepath\AppData\Roaming\npm-cache\_logs\2019-08-21T04_14_34_386Z-debug.log<br></code></pre></td></tr></table></figure>
<h2 id="错误分析"><a href="#错误分析" class="headerlink" title="错误分析"></a>错误分析</h2><p>从下向上看，最先看到的关键词是“node-gyp rebuild”，上网搜索关键词后发现出现类似的错误有很多原因。</p>
<p>错误信息往上看发现可能与python有关，这时有点怀疑想错了（nodejs关python什么事）。</p>
<p>报错的python代码是“print”方法，代码是python2的格式，但本地安装的python3，碰巧网上搜到的原因里有一条就是缺少python环境或python版本不支持。</p>
<p>为了进一步验证是否是python版本的问题，在npm库中搜索<a href="https://www.npmjs.com/package/node-gyp" target="_blank" rel="noopener">node-gyp</a>，发现确实有不支持python3的说明。</p>
<p><img src="/images/a6e104b9/20190821130203.png" alt></p>
<h2 id="修复方法"><a href="#修复方法" class="headerlink" title="修复方法"></a>修复方法</h2><p>不想修改本机python版本，python2仅用于node相关开发。</p>
<p>从<a href="https://www.python.org/downloads/release/python-2716/" target="_blank" rel="noopener">python官网</a>下载最新的python2，选择“Windows x86-64 MSI installer”，安装时不添加到环境变量（<strong>取消勾选添加到环境变量的选项</strong>）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 配置python依赖<br>node-gyp --python C:\Program Files\Python27<br>npm config set python C:\Program Files\Python27<br><br># js文件目录下，重新安装模块<br>npm i png-img<br><br># 运行js文件<br>node fakefile.js<br></code></pre></td></tr></table></figure>


            <div class="article-copyright">
                
    <blockquote>
        <p>
            版权声明：本文为「Blog.WuJiaxing.Cn」的原创文章，博客内容遵循 署名-非商业性使用-相同方式共享 协议。<br>本文永久链接是：https://blog.wujiaxing.cn/2019/08/21/a6e104b9/
        </p>
    </blockquote>


            </div>
        </div>
    </article>
    

    <section id="toc-div" >
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#报错信息"><span class="toc-text">报错信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误分析"><span class="toc-text">错误分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修复方法"><span class="toc-text">修复方法</span></a></li></ol>
    </section>
    <section id="gohome" style="display: none;"><a><i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i></a></section>


</section>
    </div>
    <footer>
    <div class="outer">
        <div class="inner">
            Powered by <a href="https://blog.wujiaxing.cn" target="_blank">ProWiki</a>
            &copy;2022 WuJiaxing<br>
            <a href="http://beian.miit.gov.cn/" target="_blank" rel="noopener">冀ICP备00000000号</a>
        </div>
    </div>
</footer>

<script src="/js/custom.js"></script>


    <script>onload_content();</script>

</body>
</html>
